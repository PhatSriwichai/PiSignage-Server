<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Groups</title>
    <link rel="stylesheet" type="text/css" href="/css/menu.css">
    <link rel="stylesheet" type="text/css" href="/css/deploy.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
 
    <script src="js/my_js.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.3.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script>
		$(document).ready(function(){
		    $("#regGroup").click(function(){
		        $("#register").slideToggle("fast");
		        /*if($("#manage").is(":visible")){
		        	$("#manage").slideToggle("fast");
		        }*/
		    });
		});
		
	</script>
	<script type="text/javascript">
		var socket = io();
		var i;
		socket.emit('route', 'group');
		socket.on('group', function(message){
			var list = document.getElementById("group");
			var string = "<option disabled selected value> -- select group for deploy--</option>";
			for(i = 0; i < message.length; i++){
				string += "<option value=\""+message[i].groupId+"\">"+message[i].groupName+"</option>";
			}
			list.innerHTML = string;
			
			
		});

		socket.emit('route', 'playlist');
		socket.on('playlist', function(message){
			var list = document.getElementById("playlist");
			var string = "<option disabled selected value> -- select playlist for deploy--</option>";
			for(i = 0; i < message.length; i++){
				string += "<option value=\""+message[i].playlistId+"\">"+message[i].playlistName+"</option>";
			}
			list.innerHTML = string;
			
			
		});

		function changeGroup(){
			var id = document.getElementById("group").value;
			var headText = document.getElementById("headText");
			headText.innerHTML = "Group "+$('#group option:selected').text();
			var socket = io();
			var i;
			socket.emit('route', 'player_in_group');
			socket.emit('player_in_group', id);
			socket.on('player_in_group', function(message){
				var list = document.getElementById("list");
				var string = '';
				for(i = 0; i < message.length; i++){
					string += "<tr><td>"+message[i].name+"</td>";
					string += "<td>"+message[i].ip+ "</td>";
					string += "<td>"+message[i].playerMac+ "</td>";
					string += "<td>"+message[i].location+ "</td>";
					string += "<td>"+message[i].status+ "</td>";
					string += "<td>"+message[i].groupName+ "</td>";
					string += "<td>"+"<a href=\"/group/deploy?group="+message[i].groupId+"\"><input id=\"buttonsub\" class=\"btn btn-success\" type=\"submit\" value=\"Deploy\">"+"</a></td></tr>";
				}
				list.innerHTML = string;
			});
			//alert(document.getElementById("group").value);
		}

		function getUrlVars()
		{
		    var vars = [], hash;
		    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		    for(var i = 0; i < hashes.length; i++)
		    {
		        hash = hashes[i].split('=');
		        vars.push(hash[0]);
		        vars[hash[0]] = hash[1];
		    }
		    return vars;
		}

		function checkConfirm(){

		}
	</script>
	<script src="js/w3data.js"></script>
</head>
<body>

	<div  w3-include-html="menu.html"></div>
	<script id="menu">w3IncludeHTML();</script> 
	
	
	
	<div id="wrapper" class="container">
  			<div class="panel-group">
   			<div class="panel panel-success">
   	   		<div class="panel-heading"><p id="headText">Players Group</p></div>
      			<div class="panel-body">
      			
      			
		<div id="sec_wrapper" name="sec_wrapper">
			<section>
			
			</section>
			<aside>
				<form method="POST" action="/deploy">
					<table>
						<tr>
							<th id="first">
								<label for="group">Groups</label>
								<select id="group" name="group" onchange="changeGroup()">
									
								</select>
							</th>
								
							<th>
								<label for="playlist">Playlist</label>
								<select id="playlist" name="playlist">
									
								</select>
							</th>	
							<th id="final"><button id="deploy" type="submit" class="btn btn-success" onclick="return confirm('Confirm for deploy')">Deploy</button>	</th>
						</tr>
					</table>
					
					<table class="table table-bordered">
						<tr>
							<th>Name</th>
							<th>IP Address</th>
							<th>Mac Address</th>
							<th>Location</th>
							<th>Status</th>
							<th>Group</th>
						</tr>
						<tbody id="list">
							
						</tbody>
					</table>

				</form>
				
				
			</aside>
		</div>
		
		
					</div>							
      			</div>
	    		</div>
    		</div>
</body>
</html>